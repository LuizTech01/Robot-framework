trigger:
  - dev

pool:
  vmImage: 'ubuntu-latest'

steps:
  - task: UsePythonVersion@0
    inputs:
      versionSpec: '3.x'

  - script: |
      sudo apt update
      sudo apt install -y wget unzip xvfb libxi6 libgconf-2-4
      wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
      sudo dpkg -i google-chrome-stable_current_amd64.deb || sudo apt -f install -y
    displayName: 'Instalar Chrome'

  - script: |
      pip install --upgrade pip
      pip install robotframework robotframework-seleniumlibrary
    displayName: 'Instalar dependÃªncias Python'

  - script: |
      sudo chmod +x drivers/chromedriver
      sudo mv drivers/chromedriver /usr/local/bin/chromedriver
    displayName: 'Usar chromedriver local'

  - script: |
      xvfb-run robot -d results tests/
    displayName: 'Executar Testes Robot Framework com Xvfb'

  - task: PublishBuildArtifacts@1
    inputs:
      pathToPublish: results
      artifactName: TestResults
    displayName: 'Publicar Resultados dos Testes'
